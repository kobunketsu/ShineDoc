<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Shine: MKStoreKit Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Shine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Instance Methods</a> &#124;
<a href="#pub-static-methods">Class Methods</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="interface_m_k_store_kit-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MKStoreKit Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for MKStoreKit:</div>
<div class="dyncontent">
 <div class="center">
  <img src="interface_m_k_store_kit.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Instance Methods</h2></td></tr>
<tr class="memitem:a637c776793aa224eb18d4ab496a59d6a" id="r_a637c776793aa224eb18d4ab496a59d6a"><td class="memItemLeft" align="right" valign="top"><a id="a637c776793aa224eb18d4ab496a59d6a" name="a637c776793aa224eb18d4ab496a59d6a"></a>
(BOOL)&#160;</td><td class="memItemRight" valign="bottom">- <b>hasValidatedReceipt</b></td></tr>
<tr class="memdesc:a637c776793aa224eb18d4ab496a59d6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">是否有验证过的收据 <br /></td></tr>
<tr class="separator:a637c776793aa224eb18d4ab496a59d6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59487633263191bc8f748571203cb562" id="r_a59487633263191bc8f748571203cb562"><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#a59487633263191bc8f748571203cb562">verifyReceiptCompletion:</a></td></tr>
<tr class="memdesc:a59487633263191bc8f748571203cb562"><td class="mdescLeft">&#160;</td><td class="mdescRight">由于直接由设备向Apple发送验证消息不安全，所以优先采用本地验证，配合服务器验证获得额外订阅消息  <br /></td></tr>
<tr class="separator:a59487633263191bc8f748571203cb562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afae4efb3383cfefec7f51b3f346f052f" id="r_afae4efb3383cfefec7f51b3f346f052f"><td class="memItemLeft" align="right" valign="top">(NSError *)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#afae4efb3383cfefec7f51b3f346f052f">iapErrorForCode:</a></td></tr>
<tr class="separator:afae4efb3383cfefec7f51b3f346f052f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf6a62b0c108e082e1033f607d2157cc" id="r_abf6a62b0c108e082e1033f607d2157cc"><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#abf6a62b0c108e082e1033f607d2157cc">startProductRequest</a></td></tr>
<tr class="separator:abf6a62b0c108e082e1033f607d2157cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99909420a2c41ddf42a058b2ae80d0da" id="r_a99909420a2c41ddf42a058b2ae80d0da"><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#a99909420a2c41ddf42a058b2ae80d0da">startProductRequestWithProductIdentifiers:</a></td></tr>
<tr class="separator:a99909420a2c41ddf42a058b2ae80d0da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf100d092a2f1abfe276b5aba732ac88" id="r_aaf100d092a2f1abfe276b5aba732ac88"><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#aaf100d092a2f1abfe276b5aba732ac88">restorePurchases</a></td></tr>
<tr class="memdesc:aaf100d092a2f1abfe276b5aba732ac88"><td class="mdescLeft">&#160;</td><td class="mdescRight">如果用户未登录apple账号，会弹出登录框  <br /></td></tr>
<tr class="separator:aaf100d092a2f1abfe276b5aba732ac88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52553309ea32348756d0f3a87a9ad6d9" id="r_a52553309ea32348756d0f3a87a9ad6d9"><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#a52553309ea32348756d0f3a87a9ad6d9">refreshAppStoreReceiptCompletion:</a></td></tr>
<tr class="separator:a52553309ea32348756d0f3a87a9ad6d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f2497f9bd377135ca5a325671fcb54" id="r_a20f2497f9bd377135ca5a325671fcb54"><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#a20f2497f9bd377135ca5a325671fcb54">initiatePaymentRequestForProductWithIdentifier:</a></td></tr>
<tr class="separator:a20f2497f9bd377135ca5a325671fcb54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea12e124cd2538d16670b5c4c98690b0" id="r_aea12e124cd2538d16670b5c4c98690b0"><td class="memItemLeft" align="right" valign="top">(BOOL)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#aea12e124cd2538d16670b5c4c98690b0">purchasedAppBeforeVersion:</a></td></tr>
<tr class="separator:aea12e124cd2538d16670b5c4c98690b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb9cd20351ed621260f3a7b42d07d317" id="r_adb9cd20351ed621260f3a7b42d07d317"><td class="memItemLeft" align="right" valign="top">(BOOL)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#adb9cd20351ed621260f3a7b42d07d317">isProductPurchased:</a></td></tr>
<tr class="separator:adb9cd20351ed621260f3a7b42d07d317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad14a6dd831e6f4ae4111779ca4cf61d4" id="r_ad14a6dd831e6f4ae4111779ca4cf61d4"><td class="memItemLeft" align="right" valign="top">(nullable NSDate *)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#ad14a6dd831e6f4ae4111779ca4cf61d4">purchaseDateForProduct:</a></td></tr>
<tr class="separator:ad14a6dd831e6f4ae4111779ca4cf61d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ecbde2c9fabaee4035bcd8f66e85111" id="r_a1ecbde2c9fabaee4035bcd8f66e85111"><td class="memItemLeft" align="right" valign="top">(nullable NSDate *)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#a1ecbde2c9fabaee4035bcd8f66e85111">expiryDateForProduct:</a></td></tr>
<tr class="memdesc:a1ecbde2c9fabaee4035bcd8f66e85111"><td class="mdescLeft">&#160;</td><td class="mdescRight">FIXME: 不再使用purchaseRecord作为判断  <br /></td></tr>
<tr class="separator:a1ecbde2c9fabaee4035bcd8f66e85111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3042adc28ccd95297607b7541699c6e" id="r_ad3042adc28ccd95297607b7541699c6e"><td class="memItemLeft" align="right" valign="top">(nullable NSDate *)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#ad3042adc28ccd95297607b7541699c6e">freeTrialExpiryDateForProduct:</a></td></tr>
<tr class="separator:ad3042adc28ccd95297607b7541699c6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d01f11aa895f7d48b5cb4cf62ec8de4" id="r_a8d01f11aa895f7d48b5cb4cf62ec8de4"><td class="memItemLeft" align="right" valign="top">(NSNumber *)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#a8d01f11aa895f7d48b5cb4cf62ec8de4">availableCreditsForConsumable:</a></td></tr>
<tr class="separator:a8d01f11aa895f7d48b5cb4cf62ec8de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac41bb9a04d6bec3a8a38851bc6830c39" id="r_ac41bb9a04d6bec3a8a38851bc6830c39"><td class="memItemLeft" align="right" valign="top">(NSNumber *)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#ac41bb9a04d6bec3a8a38851bc6830c39">consumeCredits:identifiedByConsumableIdentifier:</a></td></tr>
<tr class="separator:ac41bb9a04d6bec3a8a38851bc6830c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd4cd329bd2953d5ab0b2e030e2a521c" id="r_abd4cd329bd2953d5ab0b2e030e2a521c"><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#abd4cd329bd2953d5ab0b2e030e2a521c">setDefaultCredits:forConsumableIdentifier:</a></td></tr>
<tr class="separator:abd4cd329bd2953d5ab0b2e030e2a521c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82db88ced4ca705552692c4c38a16c80" id="r_a82db88ced4ca705552692c4c38a16c80"><td class="memItemLeft" align="right" valign="top"><a id="a82db88ced4ca705552692c4c38a16c80" name="a82db88ced4ca705552692c4c38a16c80"></a>
(BOOL)&#160;</td><td class="memItemRight" valign="bottom">- <b>hasAnyProductPurchased</b></td></tr>
<tr class="memdesc:a82db88ced4ca705552692c4c38a16c80"><td class="mdescLeft">&#160;</td><td class="mdescRight">购买过任何内购项目 <br /></td></tr>
<tr class="separator:a82db88ced4ca705552692c4c38a16c80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9807a10ef37f22b011e9d884e2a889" id="r_a0a9807a10ef37f22b011e9d884e2a889"><td class="memItemLeft" align="right" valign="top"><a id="a0a9807a10ef37f22b011e9d884e2a889" name="a0a9807a10ef37f22b011e9d884e2a889"></a>
(ios(14.0)&#160;</td><td class="memItemRight" valign="bottom">- <b>API_AVAILABLE</b></td></tr>
<tr class="memdesc:a0a9807a10ef37f22b011e9d884e2a889"><td class="mdescLeft">&#160;</td><td class="mdescRight">提供兑换优惠券的界面，可以在app中提供一个按钮 <br /></td></tr>
<tr class="separator:a0a9807a10ef37f22b011e9d884e2a889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8adef74b843dbab5ec34b4f070f17b6d" id="r_a8adef74b843dbab5ec34b4f070f17b6d"><td class="memItemLeft" align="right" valign="top"><a id="a8adef74b843dbab5ec34b4f070f17b6d" name="a8adef74b843dbab5ec34b4f070f17b6d"></a>
(BOOL)&#160;</td><td class="memItemRight" valign="bottom">- <b>isIntroductryPriceEligibleForSubscriptionGroupId:</b></td></tr>
<tr class="separator:a8adef74b843dbab5ec34b4f070f17b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73db3faacb107f05b57045f293fd6dee" id="r_a73db3faacb107f05b57045f293fd6dee"><td class="memItemLeft" align="right" valign="top">(BOOL)&#160;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_m_k_store_kit.html#a73db3faacb107f05b57045f293fd6dee">isInFreeTrialPeriodForSubscriptionIdentifier:</a></td></tr>
<tr class="separator:a73db3faacb107f05b57045f293fd6dee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Class Methods</h2></td></tr>
<tr class="memitem:a4eb7fcfdbca9f1b8ec64e981210594bb" id="r_a4eb7fcfdbca9f1b8ec64e981210594bb"><td class="memItemLeft" align="right" valign="top">(<a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> *)&#160;</td><td class="memItemRight" valign="bottom">+ <a class="el" href="interface_m_k_store_kit.html#a4eb7fcfdbca9f1b8ec64e981210594bb">sharedKit</a></td></tr>
<tr class="separator:a4eb7fcfdbca9f1b8ec64e981210594bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fcf5560ad9c1d1281f7292d894dba33" id="r_a9fcf5560ad9c1d1281f7292d894dba33"><td class="memItemLeft" align="right" valign="top">(void)&#160;</td><td class="memItemRight" valign="bottom">+ <a class="el" href="interface_m_k_store_kit.html#a9fcf5560ad9c1d1281f7292d894dba33">addIAPNotification:</a></td></tr>
<tr class="separator:a9fcf5560ad9c1d1281f7292d894dba33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a141f4947822d49c12ebd051533fdac" id="r_a1a141f4947822d49c12ebd051533fdac"><td class="memItemLeft" align="right" valign="top"><a id="a1a141f4947822d49c12ebd051533fdac" name="a1a141f4947822d49c12ebd051533fdac"></a>
(void)&#160;</td><td class="memItemRight" valign="bottom">+ <b>removeIAPNotification:</b></td></tr>
<tr class="separator:a1a141f4947822d49c12ebd051533fdac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="properties" name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:a00a74eabfb6ddac8fd0a3798a8eb9713" id="r_a00a74eabfb6ddac8fd0a3798a8eb9713"><td class="memItemLeft" align="right" valign="top">NSArray *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_m_k_store_kit.html#a00a74eabfb6ddac8fd0a3798a8eb9713">availableProducts</a></td></tr>
<tr class="separator:a00a74eabfb6ddac8fd0a3798a8eb9713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2789d2326da4dc674bc339fe05f6337" id="r_ad2789d2326da4dc674bc339fe05f6337"><td class="memItemLeft" align="right" valign="top"><a id="ad2789d2326da4dc674bc339fe05f6337" name="ad2789d2326da4dc674bc339fe05f6337"></a>
id&#160;</td><td class="memItemRight" valign="bottom"><b>delegate</b></td></tr>
<tr class="separator:ad2789d2326da4dc674bc339fe05f6337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc4eeb9a65e680c250802f131a0df2c" id="r_a8dc4eeb9a65e680c250802f131a0df2c"><td class="memItemLeft" align="right" valign="top"><a id="a8dc4eeb9a65e680c250802f131a0df2c" name="a8dc4eeb9a65e680c250802f131a0df2c"></a>
NSArray *&#160;</td><td class="memItemRight" valign="bottom"><b>noConsumeProductsDefined</b></td></tr>
<tr class="separator:a8dc4eeb9a65e680c250802f131a0df2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Method Documentation</h2>
<a id="a9fcf5560ad9c1d1281f7292d894dba33" name="a9fcf5560ad9c1d1281f7292d894dba33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fcf5560ad9c1d1281f7292d894dba33">&#9670;&#160;</a></span>addIAPNotification:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">+ (void) addIAPNotification: </td>
          <td></td>
          <td class="paramtype">(id &lt;<a class="el" href="protocol_a_c_in_app_purchase_protocol-p.html">ACInAppPurchaseProtocol</a>&gt;)&#160;</td>
          <td class="paramname"><em>iapProtocol</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>每个iapProtocol会在dealloc调用removeObserver</p>

<p>Provided by category <a class="el" href="interface_m_k_store_kit.html#a9fcf5560ad9c1d1281f7292d894dba33">MKStoreKit(Extension)</a>.</p>

</div>
</div>
<a id="a8d01f11aa895f7d48b5cb4cf62ec8de4" name="a8d01f11aa895f7d48b5cb4cf62ec8de4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d01f11aa895f7d48b5cb4cf62ec8de4">&#9670;&#160;</a></span>availableCreditsForConsumable:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSNumber *) availableCreditsForConsumable: </td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>consumableID</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract This method returns the available credits (managed by <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a>) for a given consumable</p>
<p>@discussion <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> provides a basic virtual currency manager for your consumables This method returns the available credits for a consumable A consumable ID is different from its product id, and it is configured in MKStoreKitConfigs.plist file Observe kMKStoreKitProductPurchasedNotification to get notified when the purchase of the consumable completes</p>
<p>@seealso -isProductPurchased </p>

</div>
</div>
<a id="ac41bb9a04d6bec3a8a38851bc6830c39" name="ac41bb9a04d6bec3a8a38851bc6830c39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac41bb9a04d6bec3a8a38851bc6830c39">&#9670;&#160;</a></span>consumeCredits:identifiedByConsumableIdentifier:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSNumber *) consumeCredits: </td>
          <td></td>
          <td class="paramtype">(NSNumber *)&#160;</td>
          <td class="paramname"><em>creditCountToConsume</em></td>
        </tr>
        <tr>
          <td class="paramkey">identifiedByConsumableIdentifier:</td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>consumableId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract This method updates the available credits (managed by <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a>) for a given consumable</p>
<p>@discussion <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> provides a basic virtual currency manager for your consumables This method should be called if the user consumes a consumable credit A consumable ID is different from its product id, and it is configured in MKStoreKitConfigs.plist file Observe kMKStoreKitProductPurchasedNotification to get notified when the purchase of the consumable completes</p>
<p>@seealso -isProductPurchased </p>

</div>
</div>
<a id="a1ecbde2c9fabaee4035bcd8f66e85111" name="a1ecbde2c9fabaee4035bcd8f66e85111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ecbde2c9fabaee4035bcd8f66e85111">&#9670;&#160;</a></span>expiryDateForProduct:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (nullable NSDate *) expiryDateForProduct: </td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>productId</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>FIXME: 不再使用purchaseRecord作为判断 </p>
<p>@abstract Checks the expiry date for the product identified by the given productId</p>
<p>@discussion This method checks against the local store maintained by <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> for expiry date of a given product This method can be used for Consumables/Non-Consumables/Auto-renewing subscriptions Expiry date for Consumables/Non-Consumables is always [NSNull null] Expiry date for Auto-renewing subscriptions is fetched from receipt validation server and remembered by <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> Expiry date for Auto-renewing subscriptions will be [NSNull null] for a subscription that was just purchased <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> automatically takes care of updating expiry date when a auto-renewing subscription renews Observe kMKStoreKitProductPurchasedNotification to get notified when the purchase completes Observe kMKStoreKitSubscriptionExpiredNotification to get notified when a auto-renewing subscription expires and the user has stopped the subscription</p>
<p>@seealso -isProductPurchased </p>
<p>如果没有收据，是不能直接用purchaseRecord来判断productId是否过期的。</p>
<p>收据验证不通过无法得知是否过期，只能空</p>

</div>
</div>
<a id="ad3042adc28ccd95297607b7541699c6e" name="ad3042adc28ccd95297607b7541699c6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3042adc28ccd95297607b7541699c6e">&#9670;&#160;</a></span>freeTrialExpiryDateForProduct:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (nullable NSDate *) freeTrialExpiryDateForProduct: </td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>productId</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>免费试用过期日 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">productId</td><td>&lt;#productId description#&gt; </td></tr>
  </table>
  </dd>
</dl>
<p>收据在沙盒情况下可能包含多个免费试用状态，NSEnumerationReverse显示最近的一次免费试用收据的过期时间</p>

</div>
</div>
<a id="afae4efb3383cfefec7f51b3f346f052f" name="afae4efb3383cfefec7f51b3f346f052f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afae4efb3383cfefec7f51b3f346f052f">&#9670;&#160;</a></span>iapErrorForCode:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSError *) iapErrorForCode: </td>
          <td></td>
          <td class="paramtype">(NSInteger)&#160;</td>
          <td class="paramname"><em>code</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>商店错误信息</p><ul>
<li>Parameter code: &lt;code description#&gt;</li>
</ul>
<p>errorDictionary不支持提供的信息： 21100-21199为苹果内部错误 其他从errorDictionary取 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">code</td><td>code description </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a20f2497f9bd377135ca5a325671fcb54" name="a20f2497f9bd377135ca5a325671fcb54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f2497f9bd377135ca5a325671fcb54">&#9670;&#160;</a></span>initiatePaymentRequestForProductWithIdentifier:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) initiatePaymentRequestForProductWithIdentifier: </td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>productId</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract Initiates payment request for a In App Purchasable Product</p>
<p>@discussion This method starts a payment request to App Store. Purchased products are notified through NSNotifications Observe kMKStoreKitProductPurchasedNotification to get notified when the purchase completes</p>
<p>@seealso -isProductPurchased -expiryDateForProduct</p>
<p>沙盒状态下系统弹出购买信息框，此时无法退出后台</p><ul>
<li>Parameter productId: &lt;#productId description#&gt; </li>
</ul>
<p><a href="https://developer.apple.com/library/archive/technotes/tn2413/_index.html">https://developer.apple.com/library/archive/technotes/tn2413/_index.html</a></p>

</div>
</div>
<a id="a73db3faacb107f05b57045f293fd6dee" name="a73db3faacb107f05b57045f293fd6dee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73db3faacb107f05b57045f293fd6dee">&#9670;&#160;</a></span>isInFreeTrialPeriodForSubscriptionIdentifier:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (BOOL) isInFreeTrialPeriodForSubscriptionIdentifier: </td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>productId</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>订阅是否在免费试用期内</p><ul>
<li>Parameter groupId: &lt;#groupId description#&gt; </li>
</ul>

</div>
</div>
<a id="adb9cd20351ed621260f3a7b42d07d317" name="adb9cd20351ed621260f3a7b42d07d317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb9cd20351ed621260f3a7b42d07d317">&#9670;&#160;</a></span>isProductPurchased:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (BOOL) isProductPurchased: </td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>productId</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract Checks whether the product identified by the given productId is purchased previously</p>
<p>@discussion This method checks against the local store maintained by <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> if the product was previously purchased This method can be used for Consumables/Non-Consumables/Auto-renewing subscriptions Observe kMKStoreKitProductPurchasedNotification to get notified when the purchase completes</p>
<p>@seealso -expiryDateForProduct </p>
<p>收据验证不通过</p>

</div>
</div>
<a id="aea12e124cd2538d16670b5c4c98690b0" name="aea12e124cd2538d16670b5c4c98690b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea12e124cd2538d16670b5c4c98690b0">&#9670;&#160;</a></span>purchasedAppBeforeVersion:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (BOOL) purchasedAppBeforeVersion: </td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>requiredVersion</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract Checks whether the app version the user purchased is older than the required version</p>
<p>@discussion This method checks against the local store maintained by <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> when the app was originally purchased This method can be used to determine if a user should recieve a free upgrade. For example, apps transitioning from a paid system to a freemium system can determine if users are "grandfathered-in" and exempt from extra freemium purchases.</p>
<p>@seealso -isProductPurchased </p>
<p>找不到购买记录就按照最新用户对待</p>

</div>
</div>
<a id="ad14a6dd831e6f4ae4111779ca4cf61d4" name="ad14a6dd831e6f4ae4111779ca4cf61d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad14a6dd831e6f4ae4111779ca4cf61d4">&#9670;&#160;</a></span>purchaseDateForProduct:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (nullable NSDate *) purchaseDateForProduct: </td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>productId</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>仅用于一次性购买商品的购入日期 订阅不要使用此productId查询 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">productId</td><td>&lt;#productId description#&gt; </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a52553309ea32348756d0f3a87a9ad6d9" name="a52553309ea32348756d0f3a87a9ad6d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52553309ea32348756d0f3a87a9ad6d9">&#9670;&#160;</a></span>refreshAppStoreReceiptCompletion:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) refreshAppStoreReceiptCompletion: </td>
          <td></td>
          <td class="paramtype">(ValidateHandlerWithError)&#160;</td>
          <td class="paramname"><em>completion</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract Refreshes the App Store receipt and prompts the user to authenticate.</p>
<p>@discussion This method can generate a reciept while debugging your application. In a production environment this should only be used in an appropriate context because it will present an App Store login alert to the user (without explanation).</p>
<p>MARK: 强制弹框提示用户登陆appstore，需要判断何时可以使用。 最好调用前给用户明确的提示， </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">completion</td><td>&lt;#completion description#&gt; </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaf100d092a2f1abfe276b5aba732ac88" name="aaf100d092a2f1abfe276b5aba732ac88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf100d092a2f1abfe276b5aba732ac88">&#9670;&#160;</a></span>restorePurchases</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) restorePurchases </td>
          <td></td>
          <td class="paramname"></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>如果用户未登录apple账号，会弹出登录框 </p>
<p>@abstract Restores In App Purchases made on other devices</p>
<p>@discussion This method restores your user's In App Purchases made on other devices. </p>

</div>
</div>
<a id="abd4cd329bd2953d5ab0b2e030e2a521c" name="abd4cd329bd2953d5ab0b2e030e2a521c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd4cd329bd2953d5ab0b2e030e2a521c">&#9670;&#160;</a></span>setDefaultCredits:forConsumableIdentifier:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) setDefaultCredits: </td>
          <td></td>
          <td class="paramtype">(NSNumber *)&#160;</td>
          <td class="paramname"><em>creditCount</em></td>
        </tr>
        <tr>
          <td class="paramkey">forConsumableIdentifier:</td>
          <td></td>
          <td class="paramtype">(NSString *)&#160;</td>
          <td class="paramname"><em>consumableId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract This method sets the default credits (managed by <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a>) for a given consumable</p>
<p>@discussion <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> provides a basic virtual currency manager for your consumables This method should be called if you provide free credits to start with A consumable ID is different from its product id, and it is configured in MKStoreKitConfigs.plist file Observe kMKStoreKitProductPurchasedNotification to get notified when the purchase of the consumable completes</p>
<p>@seealso -isProductPurchased </p>

</div>
</div>
<a id="a4eb7fcfdbca9f1b8ec64e981210594bb" name="a4eb7fcfdbca9f1b8ec64e981210594bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb7fcfdbca9f1b8ec64e981210594bb">&#9670;&#160;</a></span>sharedKit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">+ (<a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> *) sharedKit </td>
          <td></td>
          <td class="paramname"></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract Accessor for the shared singleton object</p>
<p>@discussion Use this to access the only object of <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> </p>
<p>如果发生退款无法反映在purchseRecord中，必须先验证</p>

</div>
</div>
<a id="abf6a62b0c108e082e1033f607d2157cc" name="abf6a62b0c108e082e1033f607d2157cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf6a62b0c108e082e1033f607d2157cc">&#9670;&#160;</a></span>startProductRequest</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) startProductRequest </td>
          <td></td>
          <td class="paramname"></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract Initializes <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> singleton by making the product request using StoreKit's SKProductRequest</p>
<p>@discussion This method should be called in your application:didFinishLaunchingWithOptions: method If this method fails, <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> will not work Most common reason for this method to fail is Internet connection being offline It's your responsibility to call startProductRequest if the Internet connection comes online and the previous call to startProductRequest failed (availableProducts.count == 0).</p>
<p>@seealso -availableProducts </p>

</div>
</div>
<a id="a99909420a2c41ddf42a058b2ae80d0da" name="a99909420a2c41ddf42a058b2ae80d0da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99909420a2c41ddf42a058b2ae80d0da">&#9670;&#160;</a></span>startProductRequestWithProductIdentifiers:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) startProductRequestWithProductIdentifiers: </td>
          <td></td>
          <td class="paramtype">(NSArray*)&#160;</td>
          <td class="paramname"><em>items</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>@abstract Initializes <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> singleton by making the product request using StoreKit's SKProductRequest</p>
<p>@discussion This method is normally called after fetching a list of products from your server. If all your products are known before hand, fill them in MKStoreKitConfigs.plist and use -startProductRequest</p>
<p>If this method fails, <a class="el" href="interface_m_k_store_kit.html">MKStoreKit</a> will not work Most common reason for this method to fail is Internet connection being offline It's your responsibility to call startProductRequest if the Internet connection comes online and the previous call to startProductRequest failed (availableProducts.count == 0).</p>
<p>@seealso -availableProducts -startProductRequest </p>

</div>
</div>
<a id="a59487633263191bc8f748571203cb562" name="a59487633263191bc8f748571203cb562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59487633263191bc8f748571203cb562">&#9670;&#160;</a></span>verifyReceiptCompletion:</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) verifyReceiptCompletion: </td>
          <td></td>
          <td class="paramtype">(ValidateHandlerWithError)&#160;</td>
          <td class="paramname"><em>completion</em></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>由于直接由设备向Apple发送验证消息不安全，所以优先采用本地验证，配合服务器验证获得额外订阅消息 </p>
<p>验证收据 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">completion</td><td>&lt;#completion description#&gt; </td></tr>
  </table>
  </dd>
</dl>
<p>本地验证通过，但缺少额外订阅信息</p>
<p>完成本地验证后再通过发送服务器进行验证，获得本地验证无法获得的订阅信息 时间可能比较长</p>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a id="a00a74eabfb6ddac8fd0a3798a8eb9713" name="a00a74eabfb6ddac8fd0a3798a8eb9713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00a74eabfb6ddac8fd0a3798a8eb9713">&#9670;&#160;</a></span>availableProducts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">- (NSArray*) availableProducts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span><span class="mlabel">write</span><span class="mlabel">atomic</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>@abstract Property that stores the list of available In App purchaseable products</p>
<p>@discussion This property is initialized after the call to startProductRequest completes If the startProductRequest fails, this property will be nil @seealso -startProductRequest </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Shine/Shine/Vender/MKStoreKit/<a class="el" href="_m_k_store_kit_8h_source.html">MKStoreKit.h</a></li>
<li>Shine/Shine/Vender/MKStoreKit/<b>MKStoreKit.m</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
